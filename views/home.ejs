<!-- Boiler plate -->
<%- include("partials/header") %>
<!-- navbar -->
<nav class="navBar">
  <div class="ui attached stackable menu">
  <div class="ui container">
      <a href="/curators" class="item"><i class="user outline icon"></i>Your Galleries</a>
    </a>
      <a href="/artists" class="item"><i class="eye icon"></i>Artist </a>
    </a>
      <a href="/curators/new" class="item"><i class="hand spock outline icon"></i>Create a Gallery </a>
    </a>
      <a href="/artists/new" class="item"><i class="plus icon"></i>Artist New</a>
    </a>
    <div class="right item">

<% if(user){ %>
      <!-- make this a butttion to destory cookies -->
      <form action="/logout?_method=DELETE" method="POST">
      <a href="/logout"><i class="frown icon"></i>
          <input class="logout" type="submit" value="logout">
        </div>
      </form>
      </div>
      </a>
<%    }else { %>

  <a href="/" onclick="signOut();">Google Sign out</a>
  <script>
    function signOut() {
    const auth2 = gapi.auth2.getAuthInstance();
      auth2.signOut().then(function () {
        console.log('User signed out.');
      });
    }
  </script>
  <% } %>
  </div>
</div>
</nav>




<!-- body -->
<div class="welcomeH1">
  <h1 >Home page</h1>
</div>
<% if(user) { %>
  <h2>Welcome to the home screen.</h2>
  <h3>Go ahead and make some gallerys and share with your friends</h3>
  <% } else {%>
    
    <h1>Register for an account</h1>
  <!-- Login -->
  <container class="loginContainer">
    <div class="ui placeholder segment">
      <div class="ui two column very relaxed stackable grid">
        <div class="column">
          <div class="ui form">
            <div class="field">
              <form action="/" method="POST">
              <label>Email</label>
                <div class="ui left icon input">
                <input type="email" name="email" placeholder="Email account">
                <i class="user icon"></i>
                </div>
            </div>
            <div class="field">
            <label>Password</label>
              <div class="ui left icon input">
                <input type="password" name="password">
                <i class="lock icon"></i>
              </div>
            </div>
        <!-- submit button login -->
              <div class="ui blue submit button">
              <input class="deleteButton login" type="submit" value="Login"></div>
              </form>
            </div>
          </div>
        <div class="middle aligned column">
      <!-- submit button sign up -->
          <div class="ui big button">
            <i class="signup icon"></i>
          <a  class="regLink" href="/register">Register</a>
          </div>
      <!-- this is where google auth will go -->
      <div class="g-signin2 ui big button" data-onsuccess="onSignIn"></div>
      <script>
        function onSignIn(googleUser) {
          const profile = googleUser.getBasicProfile();
            console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
            console.log('Name: ' + profile.getName());
            console.log('Image URL: ' + profile.getImageUrl());
            console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
            gapi.auth2.getAuthInstance();
          console.log(GoogleAuth.isSignedIn.get())



            /* new  */
            function onSignIn(googleUser) {
            var id_token = googleUser.getAuthResponse().id_token;
            var xhr = new XMLHttpRequest();
            xhr.open('POST', "http://localhost:4001/");
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.onload = function() {
            console.log('Signed in as: ' + xhr.responseText);
            };
            xhr.send('idtoken=' + id_token);
            }
        }
      </script>
        </div>
      </div>
      <div class="ui vertical divider">
    Or
      </div>
    </div>
  </container>

<% } %> 


<!-- Boiler plate -->
<%- include("partials/footer") %>